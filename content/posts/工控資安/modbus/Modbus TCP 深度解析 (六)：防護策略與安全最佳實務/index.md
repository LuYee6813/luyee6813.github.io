---
title: "Modbus TCP æ·±åº¦è§£æ (å…­)ï¼šé˜²è­·ç­–ç•¥èˆ‡å®‰å…¨æœ€ä½³å¯¦å‹™"
date: 2025-07-06
categories: [å·¥æ§è³‡å®‰]
tags: [modbus]
slug: "modbus-tcp-series-06-security-defense"
---

## 0x00 ç³»åˆ—ç¸½çµèˆ‡é˜²è­·æ¦‚è¿°

æ­¡è¿ä¾†åˆ° Modbus TCP æ·±åº¦è§£æç³»åˆ—çš„æœ€çµ‚ç¯‡ï¼åœ¨å‰é¢äº”é›†ä¸­ï¼Œæˆ‘å€‘å¾åŸºç¤å”è­°å­¸åˆ°äº†æ”»æ“ŠæŠ€è¡“ï¼Œç¾åœ¨æ˜¯æ™‚å€™å­¸ç¿’å¦‚ä½•ä¿è­·æˆ‘å€‘çš„å·¥æ§ç³»çµ±äº†ã€‚

**ç³»åˆ—å›é¡§ï¼š**

1. [å”è­°åŸºç¤èˆ‡å°åŒ…çµæ§‹](../modbus-tcp-series-01-basics/) - ç†è§£ Modbus TCP åŸºæœ¬åŸç†
2. [åŠŸèƒ½ç¢¼è©³è§£èˆ‡å¯¦æˆ°ç¯„ä¾‹](../modbus-tcp-series-02-function-codes/) - æŒæ¡å„ç¨®æ“ä½œåŠŸèƒ½
3. [è³‡æ–™æ¨¡å‹èˆ‡åœ°å€ç©ºé–“](../modbus-tcp-series-03-data-model/) - æ·±å…¥è³‡æ–™çµ„ç¹”æ–¹å¼
4. [éŒ¯èª¤è™•ç†èˆ‡ç•°å¸¸è¨ºæ–·](../modbus-tcp-series-04-error-handling/) - å­¸ç¿’æ•…éšœæ’é™¤æŠ€è¡“
5. [å®‰å…¨å¨è„…èˆ‡æ”»æ“Šåˆ†æ](../modbus-tcp-series-05-security-threats/) - äº†è§£æ½›åœ¨å¨è„…

## 0x01 å¾çœŸå¯¦æ”»æ“Šäº‹ä»¶å­¸ç¿’é˜²è­·ç­–ç•¥

### MITRE ATT&CK for ICS æ¡†æ¶æ¦‚è¿°

MITRE ATT&CK for ICS æ˜¯å°ˆé–€é‡å°å·¥æ§ç³»çµ±çš„æ”»æ“ŠæŠ€è¡“æ¡†æ¶ï¼Œå°‡æ”»æ“Šç”Ÿå‘½é€±æœŸåˆ†ç‚ºä»¥ä¸‹éšæ®µï¼š

```
ğŸ¯ Initial Access (åˆå§‹å­˜å–)
    â†“
ğŸ” Discovery (åµå¯Ÿç™¼ç¾)
    â†“
ğŸƒ Lateral Movement (æ©«å‘ç§»å‹•)
    â†“
ğŸ›ï¸ Collection (è³‡æ–™æ”¶é›†)
    â†“
ğŸ’¥ Impact (å½±éŸ¿ç ´å£)
```

è®“æˆ‘å€‘é€éçœŸå¯¦æ¡ˆä¾‹ä¾†äº†è§£æ¯å€‹éšæ®µçš„é˜²è­·ç­–ç•¥ã€‚

### æ¡ˆä¾‹ç ”ç©¶ 1ï¼šçƒå…‹è˜­é›»ç¶²æ”»æ“Šäº‹ä»¶ (2015 å¹´)

**äº‹ä»¶èƒŒæ™¯ï¼š**
2015 å¹´ 12 æœˆ 23 æ—¥ï¼Œçƒå…‹è˜­è¥¿éƒ¨é›»åŠ›å…¬å¸é­å—ç¶²è·¯æ”»æ“Šï¼Œå°è‡´ç´„ 23 è¬å±…æ°‘åœé›»æ•¸å°æ™‚ã€‚é€™æ˜¯å…¨çƒé¦–èµ·ç¢ºèªç”±ç¶²è·¯æ”»æ“Šå°è‡´çš„å¤§è¦æ¨¡åœé›»äº‹ä»¶ã€‚

**æ”»æ“Šæ™‚ç¨‹åˆ†æï¼š**

#### Initial Access (T0817 - Drive-by Compromise)

```
æ”»æ“Šæ‰‹æ³•ï¼š
- ç™¼é€å«æœ‰æƒ¡æ„é™„ä»¶çš„é‡£é­šéƒµä»¶
- ç›®æ¨™ï¼šé›»åŠ›å…¬å¸å“¡å·¥
- æƒ¡æ„æª”æ¡ˆï¼šå½è£æˆåˆæ³•æ–‡ä»¶çš„å·¨é›†ç—…æ¯’

é˜²è­·ç­–ç•¥ï¼š
âœ“ éƒµä»¶å®‰å…¨é–˜é“ï¼šæª¢æ¸¬æƒ¡æ„é™„ä»¶
âœ“ ä½¿ç”¨è€…æ„è­˜åŸ¹è¨“ï¼šè­˜åˆ¥é‡£é­šéƒµä»¶
âœ“ ç«¯é»é˜²è­·ï¼šé˜»æ­¢å·¨é›†åŸ·è¡Œ
âœ“ ç¶²è·¯åˆ†æ®µï¼šé™åˆ¶ä¼æ¥­ç¶²è·¯å°OTç¶²è·¯çš„å­˜å–
```

#### Discovery & Collection (T0840 - Network Connection Enumeration)

```
æ”»æ“Šè¡Œç‚ºï¼š
- ä½¿ç”¨ nmap æƒæå…§éƒ¨ç¶²è·¯
- ç™¼ç¾ SCADA ç³»çµ±å’Œ HMI å·¥ä½œç«™
- æ”¶é›† Modbus è¨­å‚™æ¸…å–®å’Œé…ç½®

å¯¦éš›ç™¼ç¾çš„æ¼æ´ï¼š
- æœªåŠ å¯†çš„ Modbus TCP é€šè¨Š
- é è¨­å¯†ç¢¼çš„ HMI ç³»çµ±
- ç¼ºä¹ç¶²è·¯åˆ†æ®µçš„æ‰å¹³æ¶æ§‹

é˜²è­·å»ºè­°ï¼š
âœ“ éƒ¨ç½²ç¶²è·¯ç›£æ§ï¼šæª¢æ¸¬ç•°å¸¸æƒæè¡Œç‚º
âœ“ è³‡ç”¢æ¸…å†Šç®¡ç†ï¼šäº†è§£æ‰€æœ‰é€£ç¶²è¨­å‚™
âœ“ é›¶ä¿¡ä»»æ¶æ§‹ï¼šæœ€å°æ¬Šé™åŸå‰‡
âœ“ èœœç½ç³»çµ±ï¼šèª˜æ•å’Œåµæ¸¬æ”»æ“Šè€…
```

#### Impact (T0827 - Loss of Control)

```
æœ€çµ‚æ”»æ“Šï¼š
- é ç«¯æ§åˆ¶ HMI ç³»çµ±
- æ‰‹å‹•é—œé–‰è®Šé›»ç«™æ–·è·¯å™¨
- è¦†å¯« PLC éŸŒé«”é€ æˆè¨­å‚™ç„¡æ³•é‡å•Ÿ

é—œéµå¤±èª¤ï¼š
- HMI ç³»çµ±å¯ç›´æ¥æ§åˆ¶é—œéµè¨­å‚™
- ç¼ºä¹æ“ä½œé©—è­‰æ©Ÿåˆ¶
- æ²’æœ‰å®‰å…¨çš„è¨­å‚™å¾©åŸç¨‹åº

æ”¹å–„æªæ–½ï¼š
âœ“ é›™å› ç´ èªè­‰ï¼šæ‰€æœ‰é—œéµæ“ä½œéœ€è¦é©—è­‰
âœ“ æ“ä½œç¢ºèªï¼šé‡è¦å‹•ä½œéœ€è¦é›™äººæˆæ¬Š
âœ“ å®‰å…¨å‚™ä»½ï¼šé›¢ç·šå„²å­˜ PLC ç¨‹å¼å‚™ä»½
âœ“ æ‡‰æ€¥ç¨‹åºï¼šæ‰‹å‹•æ“ä½œå‚™æ´æ©Ÿåˆ¶
```

### æ¡ˆä¾‹ç ”ç©¶ 2ï¼šTriton/TRISIS æ”»æ“Š (2017 å¹´)

**äº‹ä»¶èƒŒæ™¯ï¼š**
2017 å¹´ï¼Œä¸­æ±æŸçŸ³åŒ–å» é­å—é‡å°å®‰å…¨å„€éŒ¶ç³»çµ± (SIS) çš„é«˜ç´šæ”»æ“Šï¼Œé€™æ˜¯é¦–æ¬¡ç›´æ¥æ”»æ“Šå·¥å» å®‰å…¨ç³»çµ±çš„äº‹ä»¶ã€‚

**æŠ€è¡“åˆ†æï¼š**

#### Lateral Movement (T0866 - Exploitation of Remote Services)

```
æ”»æ“Šè·¯å¾‘ï¼š
ä¼æ¥­ç¶²è·¯ â†’ DMZ â†’ å·¥ç¨‹å¸«å·¥ä½œç«™ â†’ SIS ç¶²è·¯

é—œéµå¼±é»ï¼š
- å·¥ç¨‹å¸«å·¥ä½œç«™åŒæ™‚é€£æ¥ä¼æ¥­ç¶²è·¯å’ŒSISç¶²è·¯
- SIS ç¶²è·¯ç¼ºä¹å…¥ä¾µæª¢æ¸¬
- Tristation é€šè¨Šå”è­°æœªåŠ å¯†

MITRE å°æ‡‰æŠ€è¡“ï¼š
- T0866: Exploitation of Remote Services
- T0859: Valid Accounts (ä½¿ç”¨æœ‰æ•ˆå¸³è™Ÿ)
- T0847: Replication Through Removable Media
```

#### Collection & Impact (T0873 - Project File Discovery)

```
æ”»æ“Šç›®æ¨™ï¼š
- Schneider Electric Tristation è»Ÿé«”
- ä¿®æ”¹ SIS é‚è¼¯ç¨‹å¼
- ç¹éå®‰å…¨è¯é–åŠŸèƒ½

å¯¦éš›å½±éŸ¿ï¼š
- å¹¸é‹çš„æ˜¯ï¼Œæ”»æ“Šè€…çš„æƒ¡æ„ç¨‹å¼å­˜åœ¨ bug
- SIS ç³»çµ±é€²å…¥å®‰å…¨æ¨¡å¼è€Œéè¢«æ§åˆ¶
- å·¥å» ç·Šæ€¥åœæ©Ÿä½†é¿å…äº†ç½é›£

é˜²è­·ç­–ç•¥ï¼š
âœ“ ç‰©ç†éš”é›¢ï¼šSIS ç³»çµ±å®Œå…¨é›¢ç·š
âœ“ å–®å‘é€šè¨Šï¼šæ•¸æ“šåªèƒ½ç”± SIS å‘å¤–å‚³é€
âœ“ å°ˆç”¨å·¥ç¨‹å¸«å·¥ä½œç«™ï¼šåƒ…ç”¨æ–¼ SIS ç¶­è­·
âœ“ åš´æ ¼è®Šæ›´ç®¡æ§ï¼šæ‰€æœ‰ç¨‹å¼ä¿®æ”¹éœ€è¦æ ¸å‡†
```

### æ¡ˆä¾‹ç ”ç©¶ 3ï¼šColonial Pipeline æ”»æ“Š (2021 å¹´)

**äº‹ä»¶èƒŒæ™¯ï¼š**
2021 å¹´ 5 æœˆï¼Œç¾åœ‹æœ€å¤§çš„æˆå“æ²¹ç®¡ç·š Colonial Pipeline é­å—å‹’ç´¢è»Ÿé«”æ”»æ“Šï¼Œå°è‡´ç®¡ç·šé—œé–‰ 6 å¤©ï¼Œå½±éŸ¿ç¾åœ‹æ±å²¸ç‡ƒæ²¹ä¾›æ‡‰ã€‚

#### Initial Access (T0883 - Internet Accessible Device)

```
æ”»æ“Šå…¥å£ï¼š
- éæœŸçš„ VPN å¸³è™Ÿä»ç„¶æœ‰æ•ˆ
- ç¼ºä¹å¤šå› ç´ èªè­‰
- å¼±å¯†ç¢¼ä¿è­·

DarkSide å‹’ç´¢è»Ÿé«”ç‰¹å¾µï¼š
- é¿å…æ”»æ“Šå·¥æ§ç³»çµ±ï¼ˆRaaS é›†åœ˜çš„ã€Œè·æ¥­é“å¾·ã€ï¼‰
- ä¸»è¦åŠ å¯†ä¼æ¥­ IT ç³»çµ±
- è¦æ±‚æ¯”ç‰¹å¹£è´–é‡‘

å¯¦éš› Modbus ç›¸é—œå½±éŸ¿ï¼š
- SCADA ç³»çµ±æœ¬èº«æœªå—ç›´æ¥æ”»æ“Š
- ä½†å…¬å¸å‡ºæ–¼è¬¹æ…é—œé–‰äº† OT ç³»çµ±
- å±•ç¾äº† IT/OT ç³»çµ±ç›¸äº’ä¾è³´æ€§
```

#### Lessons Learned - Modbus é˜²è­·é‡é»ï¼š

```
é—œéµç™¼ç¾ï¼š
1. IT ç³»çµ±è¢«æ”»é™·å¯èƒ½å°è‡´ OT ç³»çµ±åœæ©Ÿ
2. å³ä½¿ OT ç³»çµ±å®‰å…¨ï¼Œæ¥­å‹™ä»å¯èƒ½ä¸­æ–·
3. æ‡‰æ€¥ç¨‹åºå’Œå¾©åŸèƒ½åŠ›åŒæ¨£é‡è¦

é˜²è­·å»ºè­°ï¼š
âœ“ IT/OT ç¶²è·¯å®Œå…¨åˆ†é›¢
âœ“ å»ºç«‹é›¢ç·šçš„æ‡‰æ€¥æ“ä½œç¨‹åº
âœ“ å®šæœŸé€²è¡Œæ¥­å‹™é€£çºŒæ€§æ¼”ç·´
âœ“ å»ºç«‹å®‰å…¨çš„é ç«¯å­˜å–æ©Ÿåˆ¶
```

## 0x02 åŸºæ–¼ ATT&CK çš„ Modbus é˜²è­·çŸ©é™£

### Initial Access éšæ®µé˜²è­·

#### T0817 Drive-by Compromise

```
å¨è„…å ´æ™¯ï¼š
æ”»æ“Šè€…é€éé‡£é­šéƒµä»¶é€²å…¥ä¼æ¥­ç¶²è·¯ï¼Œç„¶å¾Œå˜—è©¦å­˜å– Modbus ç³»çµ±

é˜²è­·ç­–ç•¥ï¼š
ğŸ›¡ï¸ æŠ€è¡“æ§åˆ¶ï¼š
- éƒµä»¶å®‰å…¨é–˜é“ (SEG)
- ç«¯é»åµæ¸¬èˆ‡å›æ‡‰ (EDR)
- ç¶²è·¯å­˜å–æ§åˆ¶ (NAC)

ğŸ“ ç®¡ç†æ§åˆ¶ï¼š
- è³‡å®‰æ„è­˜åŸ¹è¨“
- äº‹ä»¶å›æ‡‰ç¨‹åº
- å®šæœŸæ»²é€æ¸¬è©¦

ğŸ“‹ ç¨‹åºæ§åˆ¶ï¼š
- æœ€å°æ¬Šé™åŸå‰‡
- è·è²¬åˆ†é›¢
- å®šæœŸæ¬Šé™æª¢è¦–
```

#### T0819 Exploit Public-Facing Application

```
Modbus ç‰¹å®šé¢¨éšªï¼š
- HMI Web ä»‹é¢æš´éœ²åœ¨ç¶²éš›ç¶²è·¯
- Modbus TCP åŸ ç›´æ¥å°å¤–é–‹æ”¾
- é è¨­å¯†ç¢¼æœªæ›´æ”¹

çœŸå¯¦æ¡ˆä¾‹ - Shodan æœå°‹çµæœï¼š
"æˆªè‡³2024å¹´ï¼Œå…¨çƒä»æœ‰è¶…é1,000å€‹ Modbus è¨­å‚™
ç›´æ¥æš´éœ²åœ¨ç¶²éš›ç¶²è·¯ä¸Šï¼Œä¸»è¦åˆ†å¸ƒåœ¨ï¼š
- ç¾åœ‹ï¼š35%
- å¾·åœ‹ï¼š15%
- ä¸­åœ‹ï¼š12%
- ä¿„ç¾…æ–¯ï¼š8%"

é˜²è­·å¯¦å‹™ï¼š
âœ“ çµ•ä¸å°‡ Modbus è¨­å‚™ç›´æ¥é€£ç¶²
âœ“ ä½¿ç”¨ VPN æˆ–å°ˆç·šé€²è¡Œé ç«¯å­˜å–
âœ“ å¯¦æ–½ IP ç™½åå–®é™åˆ¶
âœ“ å®šæœŸé€²è¡Œå¤–éƒ¨æƒææª¢æ¸¬
```

### Discovery éšæ®µé˜²è­·

#### T0840 Network Connection Enumeration

```
æ”»æ“Šç‰¹å¾µï¼š
- ä½¿ç”¨ nmap æƒæ Modbus è¨­å‚™
- åˆ©ç”¨ Modbus åŠŸèƒ½ç¢¼ 0x2B é€²è¡Œè¨­å‚™è­˜åˆ¥
- é€é 502 åŸ å—…æ¢ç™¼ç¾è¨­å‚™

æª¢æ¸¬æŠ€è¡“ï¼š
ğŸ” ç¶²è·¯ç›£æ§ï¼š
- ç•°å¸¸æƒæè¡Œç‚ºåµæ¸¬
- å¤§é‡é€£ç·šå˜—è©¦è­¦å ±
- éæ¨™æº– Modbus è«‹æ±‚ç›£æ§

ğŸ“Š è¡Œç‚ºåˆ†æï¼š
- å»ºç«‹æ­£å¸¸æµé‡åŸºç·š
- åµæ¸¬ç•°å¸¸åŠŸèƒ½ç¢¼ä½¿ç”¨
- ç›£æ§è¨­å‚™è­˜åˆ¥è«‹æ±‚

å¯¦éš›éƒ¨ç½²æ¡ˆä¾‹ï¼š
æŸæ±½è»Šå·¥å» éƒ¨ç½² Claroty å·¥æ§å®‰å…¨å¹³å°å¾Œï¼Œ
æˆåŠŸæª¢æ¸¬åˆ°å…§éƒ¨å·¥ç¨‹å¸«å·¥ä½œç«™çš„ç•°å¸¸æƒæè¡Œç‚ºï¼Œ
åŸä¾†æ˜¯æ–°å®‰è£çš„ç›£æ§è»Ÿé«”é…ç½®éŒ¯èª¤ã€‚
```

### Lateral Movement éšæ®µé˜²è­·

#### T0859 Valid Accounts

```
é¢¨éšªå ´æ™¯ï¼š
æ”»æ“Šè€…ç²å¾—æœ‰æ•ˆçš„ SCADA å¸³è™Ÿï¼Œé€é Modbus æ“ä½œè¨­å‚™

é˜²è­·ç­–ç•¥ï¼š
ğŸ” èº«ä»½ç®¡ç†ï¼š
- å¼·åˆ¶å¤šå› ç´ èªè­‰
- å®šæœŸå¯†ç¢¼æ›´æ›
- å¸³è™Ÿç”Ÿå‘½é€±æœŸç®¡ç†

ğŸ” è¡Œç‚ºç›£æ§ï¼š
- ç•°å¸¸ç™»å…¥æ™‚é–“åµæ¸¬
- åœ°ç†ä½ç½®ç•°å¸¸è­¦å ±
- æ¬Šé™æå‡ç›£æ§

çœŸå¯¦æ¡ˆä¾‹ - Stuxnet å€Ÿé‘‘ï¼š
é›–ç„¶ Stuxnet ä¸»è¦é‡å° Siemens PLCï¼Œä½†å…¶ä½¿ç”¨
æœ‰æ•ˆæ†‘è­‰çš„æŠ€è¡“åŒæ¨£é©ç”¨æ–¼ Modbus ç’°å¢ƒï¼š
- ç«Šå–çš„æ•¸ä½æ†‘è­‰
- æœ‰æ•ˆçš„ä½¿ç”¨è€…å¸³è™Ÿ
- åˆæ³•çš„å·¥ç¨‹è»Ÿé«”
```

### Impact éšæ®µé˜²è­·

#### T0827 Loss of Control

```
æœ€çµ‚æ”»æ“Šç›®æ¨™ï¼š
- ç«„æ”¹ Modbus è¨­å®šé»
- é—œé–‰é—œéµè¨­å‚™
- ç ´å£ç”Ÿç”¢ç¨‹åº

å¤šå±¤é˜²è­·ç­–ç•¥ï¼š

ğŸ­ ç‰©ç†å±¤ï¼š
- å®‰å…¨å„€éŒ¶ç³»çµ± (SIS) ç¨ç«‹é‹ä½œ
- ç¡¬é«”å®‰å…¨é–‹é—œ
- ç·Šæ€¥åœæ©ŸæŒ‰éˆ•

âš™ï¸ æ§åˆ¶å±¤ï¼š
- PLC ç¨‹å¼ç¢¼ä¿è­·
- å®‰å…¨åŠŸèƒ½å¡Š
- ç¡¬é«”å¯«ä¿è­·

ğŸ“¡ é€šè¨Šå±¤ï¼š
- Modbus åŠŸèƒ½ç¢¼ç™½åå–®
- åœ°å€ç¯„åœé™åˆ¶
- æ“ä½œé€Ÿç‡é™åˆ¶

å¯¦éš›æ¡ˆä¾‹ - å°ç£æŸåŠå°é«”å» ï¼š
å¯¦æ–½äº†å››é‡ä¿è­·æ©Ÿåˆ¶ï¼š
1. SCADA æ“ä½œéœ€é›™äººç¢ºèª
2. é—œéµåƒæ•¸è®Šæ›´éœ€ä¸»ç®¡æˆæ¬Š
3. PLC ç¨‹å¼æœ‰ç¡¬é«”å¯«ä¿è­·
4. ç•°å¸¸æ“ä½œè‡ªå‹•è§¸ç™¼å®‰å…¨ç¨‹åº
```

## 0x03 åœ‹éš›æ¡ˆä¾‹åˆ†æï¼šç¶²è·¯åˆ†æ®µé˜²è­·ç­–ç•¥

### æ¡ˆä¾‹ä¸€ï¼šå¾·åœ‹å·¥æ¥­ 4.0 æœ€ä½³å¯¦å‹™

**èƒŒæ™¯ï¼š**
å¾·åœ‹æŸæ±½è»Šè£½é€ å•†æ ¹æ“š IEC 62443 æ¨™æº–ï¼Œå»ºç«‹äº†äº”å±¤ç¶²è·¯å®‰å…¨æ¶æ§‹ï¼Œæœ‰æ•ˆé˜²è­·äº†åŒ…å« 300+ Modbus è¨­å‚™çš„ç”Ÿç”¢ç·šã€‚

**ç¶²è·¯åˆ†æ®µè¨­è¨ˆï¼š**

```
ğŸŒ Level 5: ä¼æ¥­ç¶²è·¯ (Enterprise Zone)
   â”œâ”€â”€ ERP ç³»çµ±ã€éƒµä»¶ä¼ºæœå™¨
   â””â”€â”€ é˜²ç«ç‰† â†“

ğŸ¢ Level 4: DMZ å€åŸŸ (DMZ Zone)
   â”œâ”€â”€ è³‡æ–™å²å­¸ä¼ºæœå™¨ã€å ±è¡¨ç³»çµ±
   â””â”€â”€ å·¥æ¥­é˜²ç«ç‰† â†“

ğŸ“Š Level 3: SCADA ç¶²è·¯ (SCADA Zone)
   â”œâ”€â”€ HMI å·¥ä½œç«™ã€æ­·å²ä¼ºæœå™¨
   â””â”€â”€ æ·±åº¦å°åŒ…æª¢æ¸¬ â†“

âš™ï¸ Level 2: æ§åˆ¶ç¶²è·¯ (Control Zone)
   â”œâ”€â”€ PLCã€Modbus RTU Gateway
   â””â”€â”€ å–®å‘é€šè¨Š â†“

ğŸ”’ Level 1: å®‰å…¨ç¶²è·¯ (Safety Zone)
   â””â”€â”€ SIS ç³»çµ± (å®Œå…¨éš”é›¢)
```

**é˜²è­·æˆæ•ˆï¼š**

- 2019-2023 å¹´ï¼šé›¶èµ·å·¥æ§å®‰å…¨äº‹ä»¶
- æ¯å¹´é€šé ISO 27001 ç¨½æ ¸
- å¹³å‡åœæ©Ÿæ™‚é–“æ¸›å°‘ 60%

### æ¡ˆä¾‹äºŒï¼šæ—¥æœ¬æ ¸é›»å»  Modbus é˜²è­·ç¶“é©—

**ç›£ç®¡è¦æ±‚ï¼š**
æ—¥æœ¬æ ¸èƒ½è¦åˆ¶å»³è¦æ±‚æ‰€æœ‰æ ¸é›»å» å¿…é ˆå¯¦æ–½ç¸±æ·±é˜²ç¦¦ï¼Œç‰¹åˆ¥é‡å°æ•¸ä½åŒ–æ§åˆ¶ç³»çµ±ã€‚

**å…·é«”å¯¦æ–½æªæ–½ï¼š**

1. **ç‰©ç†éš”é›¢ (Air Gap)**

   ```
   å®‰å…¨ç›¸é—œç³»çµ±ï¼š
   - åæ‡‰å™¨ä¿è­·ç³»çµ±å®Œå…¨é›¢ç·š
   - å°ˆç”¨ Modbus ç¶²è·¯ï¼Œç„¡å¤–éƒ¨é€£æ¥
   - ç¡¬é«”å¯«ä¿è­·é–‹é—œ

   éå®‰å…¨ç³»çµ±ï¼š
   - å–®å‘æ•¸æ“šäºŒæ¥µç®¡
   - åƒ…å…è¨±ç›£æ§æ•¸æ“šå‘å¤–å‚³é€
   - ç¦æ­¢ä»»ä½•é ç«¯æ§åˆ¶
   ```

2. **å¤šé‡èªè­‰æ©Ÿåˆ¶**

   ```
   æ“ä½œå“¡èªè­‰ï¼š
   - æ™ºæ…§å¡ + PIN + ç”Ÿç‰©è­˜åˆ¥
   - é›™äººé©—è­‰ï¼ˆå››çœ¼åŸå‰‡ï¼‰
   - æ“ä½œéŒ„å½±å‚™æŸ¥

   ç¶­è­·å­˜å–ï¼š
   - é›¢ç·šèªè­‰ç³»çµ±
   - ç´™æœ¬ä½œæ¥­ç¨‹åº
   - ä¸»ç®¡ç¾å ´ç›£ç£
   ```

3. **ç•°å¸¸ç›£æ§ç³»çµ±**
   ```
   å³æ™‚ç›£æ§é …ç›®ï¼š
   - æ‰€æœ‰ Modbus é€šè¨Šè¨˜éŒ„
   - åƒæ•¸è®Šæ›´è­¦å ±
   - ç•°å¸¸åŠŸèƒ½ç¢¼åµæ¸¬
   - æœªæˆæ¬Šå­˜å–å˜—è©¦
   ```

**æ•™è¨“åˆ†äº«ï¼š**
è©²æ ¸é›»å» åˆ†äº«çš„é—œéµæ•™è¨“ï¼šã€ŒæŠ€è¡“é˜²è­·åªæ˜¯åŸºç¤ï¼Œäººå“¡ç®¡ç†å’Œç¨‹åºæ§åˆ¶åŒæ¨£é‡è¦ã€‚ã€

### æ¡ˆä¾‹ä¸‰ï¼šæ–°åŠ å¡æ™ºæ…§åœ‹å®¶ç¶²è·¯å®‰å…¨ç­–ç•¥

**èƒŒæ™¯ï¼š**
æ–°åŠ å¡å°‡é—œéµåŸºç¤è¨­æ–½çš„ OT å®‰å…¨åˆ—ç‚ºåœ‹å®¶æˆ°ç•¥ï¼Œå»ºç«‹äº†çµ±ä¸€çš„å·¥æ§å®‰å…¨æŒ‡å¼•ã€‚

**åœ‹å®¶ç´šé˜²è­·æ¡†æ¶ï¼š**

1. **å¼·åˆ¶æ€§å®‰å…¨æ¨™æº–**

   ```
   æ‰€æœ‰é—œéµåŸºç¤è¨­æ–½å¿…é ˆï¼š
   - å¯¦æ–½ IEC 62443 å®‰å…¨ç­‰ç´š 3
   - éƒ¨ç½²å·¥æ§å°ˆç”¨é˜²ç«ç‰†
   - å»ºç«‹ 24/7 SOC ç›£æ§
   - å®šæœŸé€²è¡Œæ»²é€æ¸¬è©¦
   ```

2. **å¨è„…æƒ…å ±åˆ†äº«æ©Ÿåˆ¶**

   ```
   SingCERT å·¥æ§å¨è„…æƒ…å ±ï¼š
   - å³æ™‚æ”»æ“ŠæŒ‡æ¨™ (IoC) åˆ†äº«
   - æ¼æ´è³‡è¨Šå¿«é€Ÿé€šå ±
   - æœ€ä½³å¯¦å‹™æ¡ˆä¾‹äº¤æµ
   - è¯åˆäº‹ä»¶å›æ‡‰æ¼”ç·´
   ```

3. **äººæ‰åŸ¹è‚²è¨ˆç•«**
   ```
   SkillsFuture OT Securityï¼š
   - å·¥æ§å®‰å…¨å·¥ç¨‹å¸«èªè­‰
   - Modbus å®‰å…¨å°ˆæ¥­èª²ç¨‹
   - å¯¦æˆ°æ”»é˜²æ¼”ç·´
   - åœ‹éš›äº¤æµå­¸ç¿’
   ```

**å¯¦éš›æˆæœï¼š**

- 2020-2024 å¹´ï¼šé—œéµåŸºç¤è¨­æ–½é›¶é‡å¤§äº‹ä»¶
- OT å®‰å…¨æˆç†Ÿåº¦æå‡ 200%
- å€åŸŸå·¥æ§å®‰å…¨æ¨™ç«¿

## 0x04 çœŸå¯¦å¨è„…æª¢æ¸¬æ¡ˆä¾‹

### æ¡ˆä¾‹ä¸€ï¼šMandiant APT33 æ”»æ“Šåˆ†æ

**äº‹ä»¶èƒŒæ™¯ï¼š**
Mandiant åœ¨ 2018 å¹´ç™¼ç¾ APT33 (Elfin) é‡å°ä¸­æ±èƒ½æºå…¬å¸çš„æ”»æ“Šæ´»å‹•ï¼Œå…¶ä¸­åŒ…å«å° Modbus ç³»çµ±çš„æ”»æ“Šå˜—è©¦ã€‚

**æ”»æ“ŠæŠ€è¡“åˆ†æï¼š**

1. **T0886 Remote Services (é ç«¯æœå‹™åˆ©ç”¨)**

   ```
   æ”»æ“Šè·¯å¾‘ï¼š
   Internet â†’ VPN â†’ å·¥ç¨‹å¸«å·¥ä½œç«™ â†’ SCADA ç¶²è·¯

   åˆ©ç”¨å·¥å…·ï¼š
   - è‡ªè£½ Modbus æƒæå™¨
   - Python è…³æœ¬é€²è¡Œè¨­å‚™æŒ‡ç´‹è­˜åˆ¥
   - åŠŸèƒ½ç¢¼ 0x2B æ”¶é›†è¨­å‚™è³‡è¨Š

   æ”»æ“Šç‰¹å¾µï¼š
   - å¤§é‡é€£çºŒçš„ Modbus é€£ç·šå˜—è©¦
   - éæ¨™æº–çš„åŠŸèƒ½ç¢¼çµ„åˆ
   - ç•°å¸¸çš„è«‹æ±‚æ™‚é–“æ¨¡å¼
   ```

2. **æª¢æ¸¬æŠ€è¡“å¯¦ä¾‹**

   ```
   Dragos å¹³å°æª¢æ¸¬åˆ°çš„ç•°å¸¸ï¼š
   âš ï¸ é«˜é »ç‡è¨­å‚™æƒæ
   âš ï¸ éæ¥­å‹™æ™‚é–“çš„ Modbus æ´»å‹•
   âš ï¸ ä¾†è‡ªéæˆæ¬Š IP çš„é€£ç·š
   âš ï¸ ç•°å¸¸çš„åŠŸèƒ½ç¢¼ä½¿ç”¨æ¨¡å¼

   è‡ªå‹•å›æ‡‰æªæ–½ï¼š
   âœ“ å³æ™‚é˜»æ–·å¯ç–‘é€£ç·š
   âœ“ éš”é›¢å—å½±éŸ¿çš„å·¥ä½œç«™
   âœ“ é€šçŸ¥å®‰å…¨é‹ç‡Ÿä¸­å¿ƒ
   âœ“ å•Ÿå‹•äº‹ä»¶å›æ‡‰ç¨‹åº
   ```

### æ¡ˆä¾‹äºŒï¼šSchneider Electric EcoStruxure èœœç½ç ”ç©¶

**ç ”ç©¶ç›®çš„ï¼š**
Schneider Electric èˆ‡ Cymmetria åˆä½œï¼Œéƒ¨ç½²å·¥æ§èœœç½ç³»çµ±ç ”ç©¶é‡å° Modbus è¨­å‚™çš„æ”»æ“Šè¶¨å‹¢ã€‚

**ç™¼ç¾çš„æ”»æ“Šæ¨¡å¼ï¼š**

1. **è‡ªå‹•åŒ–æƒææ”»æ“Š**

   ```
   çµ±è¨ˆæ•¸æ“š (2023å¹´)ï¼š
   - æ¯å¤©å¹³å‡ 1,200 æ¬¡ Modbus æƒæå˜—è©¦
   - 95% ä¾†è‡ªè‡ªå‹•åŒ–å·¥å…·
   - ä¸»è¦æƒæåŠŸèƒ½ç¢¼ï¼š0x03, 0x04, 0x2B

   æ”»æ“Šä¾†æºåˆ†å¸ƒï¼š
   - ä¸­åœ‹ï¼š35%
   - ä¿„ç¾…æ–¯ï¼š22%
   - ç¾åœ‹ï¼š18%
   - å…¶ä»–ï¼š25%
   ```

2. **é€²éšæŒçºŒå¨è„… (APT)**

   ```
   è¡Œç‚ºç‰¹å¾µï¼š
   - ç·©æ…¢çš„åµå¯Ÿæ´»å‹•ï¼ˆæ•¸é€±æ™‚é–“ï¼‰
   - æ¨¡ä»¿æ­£å¸¸æ¥­å‹™æµé‡
   - é‡å°ç‰¹å®šå» å•†è¨­å‚™
   - å˜—è©¦è®€å–é—œéµé…ç½®åƒæ•¸

   é˜²è­·å»ºè­°ï¼š
   âœ“ å»ºç«‹æ­£å¸¸æµé‡åŸºç·š
   âœ“ å¯¦æ–½è¡Œç‚ºåˆ†æ
   âœ“ éƒ¨ç½²æ¬ºé¨™æŠ€è¡“
   âœ“ å¼·åŒ–æ“ä½œå“¡åŸ¹è¨“
   ```

### æ¡ˆä¾‹ä¸‰ï¼šCISA ICS-CERT é€šå ±æ¡ˆä¾‹ç ”ç©¶

**ICS-CERT-21-103-01: Modbus è¨­å‚™é ç«¯ç¨‹å¼ç¢¼åŸ·è¡Œæ¼æ´**

**æ¼æ´è©³æƒ…ï¼š**

```
å½±éŸ¿è¨­å‚™ï¼š
- å¤šæ¬¾å·¥æ¥­ HMI ç³»çµ±
- Modbus TCP/IP é€šè¨Šæ¨¡çµ„
- ç¬¬ä¸‰æ–¹ Modbus å‡½å¼åº«

æŠ€è¡“ç´°ç¯€ï¼š
- CVE-2021-22681: ç·©è¡å€æº¢ä½
- CVE-2021-22682: æ ¼å¼å­—ä¸²æ¼æ´
- æ”»æ“Šå‘é‡ï¼šæƒ¡æ„ Modbus å°åŒ…

CVSS è©•åˆ†ï¼š9.8 (åš´é‡)
```

**å¯¦éš›æ”»æ“Šæ¡ˆä¾‹ï¼š**

```
å—å®³è€…ï¼šç¾åœ‹æŸæ°´è™•ç†å» 
æ”»æ“Šæ‰‹æ³•ï¼š
1. é€éç¶²è·¯æƒæç™¼ç¾è„†å¼±çš„ HMI ç³»çµ±
2. ç™¼é€ç•¸å½¢ Modbus å°åŒ…è§¸ç™¼æ¼æ´
3. ç²å¾— HMI ç³»çµ±æ§åˆ¶æ¬Š
4. å˜—è©¦ä¿®æ”¹æ°´è™•ç†åƒæ•¸

å¹¸é‹çµæœï¼š
- å®‰å…¨å„€éŒ¶ç³»çµ±åŠæ™‚ä»‹å…¥
- ç•°å¸¸åƒæ•¸è¢«è‡ªå‹•ä¿®æ­£
- æœªé€ æˆå¯¦éš›å±å®³

é˜²è­·æªæ–½ï¼š
âœ“ ç«‹å³å¥—ç”¨å®‰å…¨æ›´æ–°
âœ“ å¯¦æ–½ Modbus å°åŒ…éæ¿¾
âœ“ åŠ å¼·ç¶²è·¯ç›£æ§
âœ“ æª¢è¨æ‡‰æ€¥ç¨‹åº
```

```

## 0x03 æ‡‰ç”¨å±¤å®‰å…¨å¼·åŒ–

## 0x05 äº‹ä»¶å›æ‡‰èˆ‡æ¢å¾©å¯¦æˆ°

### æ¡ˆä¾‹ä¸€ï¼šNotPetya å° Maersk çš„è¡æ“Š (2017å¹´)

**äº‹ä»¶èƒŒæ™¯ï¼š**
2017å¹´6æœˆï¼ŒNotPetya å‹’ç´¢è»Ÿé«”æ”»æ“Šäº†å…¨çƒèˆªé‹å·¨é ­ Maerskï¼Œé›–ç„¶ä¸»è¦å½±éŸ¿ IT ç³»çµ±ï¼Œä½†ä¹Ÿæ³¢åŠåˆ°æ¸¯å£çš„ Modbus æ§åˆ¶ç³»çµ±ã€‚

**å½±éŸ¿åˆ†æï¼š**
```

ç›´æ¥å½±éŸ¿ï¼š

- å…¨çƒ 76 å€‹æ¸¯å£ä½œæ¥­ä¸­æ–·
- é›†è£ç®±è¿½è¹¤ç³»çµ±é›¢ç·š
- è‡ªå‹•åŒ–èµ·é‡æ©Ÿåœæ­¢é‹ä½œ

Modbus ç³»çµ±å½±éŸ¿ï¼š

- èµ·é‡æ©Ÿæ§åˆ¶ç³»çµ±å› ç¶²è·¯éš”é›¢è€Œåœæ©Ÿ
- è²¨æ«ƒå®šä½æ„Ÿæ¸¬å™¨å¤±å»é€šè¨Š
- æ¸¯å£é–˜é–€æ§åˆ¶ç³»çµ±åˆ‡æ›åˆ°æ‰‹å‹•æ¨¡å¼

ç¶“æ¿Ÿæå¤±ï¼š

- ç›´æ¥æå¤±ï¼š2-3 å„„ç¾å…ƒ
- æ¢å¾©æ™‚é–“ï¼š10 å¤©
- æ¥­å‹™ä¸­æ–·ï¼šå½±éŸ¿å…¨çƒè²¿æ˜“

```

**æ‡‰æ€¥å›æ‡‰ç¨‹åºï¼š**
```

Hour 0-2: åˆæœŸå›æ‡‰
âœ“ ç«‹å³æ–·é–‹æ‰€æœ‰ç¶²è·¯é€£ç·š
âœ“ å•Ÿå‹•ç·Šæ€¥æŒ‡æ®ä¸­å¿ƒ
âœ“ è©•ä¼°é—œéµç³»çµ±ç‹€æ…‹
âœ“ é€šçŸ¥ä¸»ç®¡æ©Ÿé—œå’Œå®¢æˆ¶

Hour 2-24: æå®³æ§åˆ¶
âœ“ è­˜åˆ¥æœªå—å½±éŸ¿çš„ç³»çµ±
âœ“ å»ºç«‹å‚™æ´é€šè¨Šç®¡é“
âœ“ å•Ÿå‹•æ‰‹å‹•ä½œæ¥­ç¨‹åº
âœ“ è¯çµ¡ç¶²è·¯å®‰å…¨å°ˆå®¶

Day 2-10: ç³»çµ±æ¢å¾©
âœ“ é‡å»º IT åŸºç¤è¨­æ–½
âœ“ é€æ­¥æ¢å¾© OT ç³»çµ±
âœ“ åŠ å¼·å®‰å…¨ç›£æ§
âœ“ é©—è­‰ç³»çµ±å®Œæ•´æ€§

```

**å­¸åˆ°çš„æ•™è¨“ï¼š**
1. **IT/OT ç³»çµ±ç›¸äº’ä¾è³´æ€§**ï¼šå³ä½¿æ”»æ“Šä¸»è¦é‡å° IT ç³»çµ±ï¼ŒOT ç³»çµ±ä¹Ÿæœƒå—åˆ°å½±éŸ¿
2. **å‚™æ´é€šè¨Šçš„é‡è¦æ€§**ï¼šéœ€è¦ç¨ç«‹çš„é€šè¨Šç®¡é“ä¾†å”èª¿æ¢å¾©å·¥ä½œ
3. **æ‰‹å‹•ç¨‹åºçš„å¿…è¦æ€§**ï¼šé—œéµæ¥­å‹™éœ€è¦æœ‰æ‰‹å‹•æ“ä½œçš„å‚™æ´æ–¹æ¡ˆ

### æ¡ˆä¾‹äºŒï¼šColonial Pipeline æ¢å¾©ç¶“é©— (2021å¹´)

**å¿«é€Ÿæ¢å¾©ç­–ç•¥ï¼š**

#### åˆ†æ®µæ¢å¾©æ–¹æ³•
```

Stage 1: å®‰å…¨è©•ä¼° (Day 1-2)

- éš”é›¢å—å½±éŸ¿çš„ IT ç³»çµ±
- ç¢ºèª OT ç³»çµ±å®Œæ•´æ€§
- è©•ä¼° Modbus ç¶²è·¯å®‰å…¨æ€§
- æª¢æŸ¥æ‰€æœ‰æ§åˆ¶é‚è¼¯

Stage 2: æœ‰é™é‡å•Ÿ (Day 3-4)

- æ¢å¾©é—œéµçš„ç›£æ§ç³»çµ±
- å•Ÿå‹•æœ¬åœ°æ‰‹å‹•æ§åˆ¶
- æ¸¬è©¦å®‰å…¨å„€éŒ¶ç³»çµ±
- é©—è­‰ Modbus é€šè¨Š

Stage 3: å…¨é¢é‹ç‡Ÿ (Day 5-6)

- æ¢å¾©è‡ªå‹•åŒ–æ§åˆ¶
- é‡æ–°å»ºç«‹é ç«¯ç›£æ§
- å•Ÿå‹•æ­£å¸¸èª¿åº¦ç³»çµ±
- å›åˆ°å®Œå…¨é‹ç‡Ÿç‹€æ…‹

```

#### æ¥­å‹™é€£çºŒæ€§æªæ–½
```

çŸ­æœŸæ‡‰å° (0-72 å°æ™‚)ï¼š

- å•Ÿå‹•ç´™æœ¬ç¨‹åº
- éƒ¨ç½²é¡å¤–äººåŠ›
- ä½¿ç”¨è¡›æ˜Ÿé›»è©±é€šè¨Š
- å¯¦æ–½æ‰‹å‹•ç›£æ§

ä¸­æœŸæ¢å¾© (3-14 å¤©)ï¼š

- å»ºç«‹è‡¨æ™‚æ§åˆ¶ä¸­å¿ƒ
- éƒ¨ç½²è¡Œå‹• SCADA ç³»çµ±
- åŠ å¼·ç¾å ´å·¡æª¢
- å»ºç«‹å‚™æ´é€šè¨Š

é•·æœŸå¼·åŒ– (14 å¤©ä»¥ä¸Š)ï¼š

- å‡ç´šç¶²è·¯å®‰å…¨ç³»çµ±
- åŠ å¼· IT/OT åˆ†é›¢
- å»ºç«‹ç•°åœ°å‚™æ´
- å¼·åŒ–äººå“¡åŸ¹è¨“

```

### æ¡ˆä¾‹ä¸‰ï¼šå°ç£åŠå°é«”å» åœ°éœ‡æ‡‰è®Š

**èƒŒæ™¯ï¼š**
å°ç£æŸæ™¶åœ“å» åœ¨ 921 åœ°éœ‡å¾Œï¼Œå»ºç«‹äº†å®Œæ•´çš„ç½å®³æ¢å¾©è¨ˆç•«ï¼ŒåŒ…æ‹¬ Modbus æ§åˆ¶ç³»çµ±çš„å¿«é€Ÿæ¢å¾©ç¨‹åºã€‚

**æ¢å¾©å„ªå…ˆç´šè¨­å®šï¼š**
```

Priority 1: å®‰å…¨ç³»çµ± (0-30 åˆ†é˜)

- ç·Šæ€¥åœæ©Ÿç³»çµ±æª¢æŸ¥
- åŒ–å­¸å“æ´©æ¼åµæ¸¬
- æ¶ˆé˜²ç³»çµ±ç¢ºèª
- äººå“¡ç–æ•£ç³»çµ±

Priority 2: é—œéµæ§åˆ¶ (30 åˆ†é˜-2 å°æ™‚)

- æ½”æ·¨å®¤ç’°æ§ç³»çµ±
- é›»åŠ›é…é›»ç³»çµ±
- ç´”æ°´ä¾›æ‡‰ç³»çµ±
- åŒ–å­¸å“ä¾›æ‡‰æ§åˆ¶

Priority 3: ç”Ÿç”¢è¨­å‚™ (2-24 å°æ™‚)

- è£½ç¨‹è¨­å‚™æ§åˆ¶
- å“è³ªæª¢æ¸¬ç³»çµ±
- ç‰©æ–™æ¬é‹ç³»çµ±
- ç”Ÿç”¢æ’ç¨‹ç³»çµ±

Priority 4: æ”¯æ´ç³»çµ± (24-72 å°æ™‚)

- èƒ½æºç®¡ç†ç³»çµ±
- è¨­å‚™é ä¿ç³»çµ±
- è³‡æ–™æ”¶é›†ç³»çµ±
- å ±è¡¨ç”Ÿæˆç³»çµ±

```

**å¯¦éš›æ¼”ç·´çµæœï¼š**
```

2023 å¹´æ¼”ç·´æˆæœï¼š

- å®‰å…¨ç³»çµ±æ¢å¾©ï¼š28 åˆ†é˜ âœ“
- é—œéµæ§åˆ¶æ¢å¾©ï¼š87 åˆ†é˜ âœ“
- ç”Ÿç”¢è¨­å‚™æ¢å¾©ï¼š18 å°æ™‚ âœ“
- å®Œå…¨æ¢å¾©ï¼š65 å°æ™‚ âœ“

é—œéµæˆåŠŸå› ç´ ï¼š

- è©³ç´°çš„æ¢å¾©ç¨‹åºæ–‡ä»¶
- å®šæœŸçš„æ¼”ç·´å’Œè¨“ç·´
- å……è¶³çš„å‚™ç”¨é›¶ä»¶
- è·¨éƒ¨é–€å”èª¿æ©Ÿåˆ¶

```

## 0x06 åœ‹éš›åˆè¦èˆ‡æœ€ä½³å¯¦å‹™

### IEC 62443 å¯¦æ–½æ¡ˆä¾‹

**æ­ç›Ÿ NIS2 æŒ‡ä»¤ä¸‹çš„åˆè¦å¯¦å‹™**

éš¨è‘—æ­ç›Ÿ NIS2 æŒ‡ä»¤çš„å¯¦æ–½ï¼Œé—œéµåŸºç¤è¨­æ–½ç‡Ÿé‹å•†å¿…é ˆç¬¦åˆæ›´åš´æ ¼çš„ç¶²è·¯å®‰å…¨è¦æ±‚ã€‚

#### å¾·åœ‹è£½é€ æ¥­åˆè¦ç¶“é©—
```

æ³•è¦è¦æ±‚ï¼š

- å¯¦æ–½ IEC 62443-3-3 å®‰å…¨ç­‰ç´š 3
- å»ºç«‹ 24/7 å®‰å…¨ç›£æ§
- å®šæœŸé€²è¡Œé¢¨éšªè©•ä¼°
- å»ºç«‹äº‹ä»¶å›æ‡‰ç¨‹åº

å¯¦éš›å¯¦æ–½ï¼š
âœ“ ç¶²è·¯åˆ†æ®µï¼šå¯¦æ–½ 5 å±¤å®‰å…¨æ¶æ§‹
âœ“ å­˜å–æ§åˆ¶ï¼šå¤šå› ç´ èªè­‰ + æœ€å°æ¬Šé™
âœ“ ç›£æ§ç³»çµ±ï¼šéƒ¨ç½²å·¥æ§å°ˆç”¨ SIEM
âœ“ äº‹ä»¶å›æ‡‰ï¼šå»ºç«‹è·¨åœ‹æ‡‰è®Šåœ˜éšŠ

å¹´åº¦ç¨½æ ¸çµæœï¼š

- å®‰å…¨æˆç†Ÿåº¦ï¼šLevel 4/5
- åˆè¦æ€§ï¼š100% ç¬¦åˆè¦æ±‚
- äº‹ä»¶æ•¸é‡ï¼šè¼ƒå‰å¹´æ¸›å°‘ 75%

```

#### ç¾åœ‹ NERC CIP é›»åŠ›æ¨™æº–
```

é—œéµè¦æ±‚ï¼š

- CIP-005: é›»å­å®‰å…¨é‚Šç•Œ
- CIP-007: ç³»çµ±å®‰å…¨ç®¡ç†
- CIP-010: é…ç½®è®Šæ›´ç®¡ç†
- CIP-011: è³‡è¨Šä¿è­·

Modbus ç‰¹å®šè¦æ±‚ï¼š

- åŠ å¯†æ‰€æœ‰ Modbus TCP é€šè¨Š
- å¯¦æ–½ Modbus åŠŸèƒ½ç¢¼ç™½åå–®
- è¨˜éŒ„æ‰€æœ‰ Modbus æ“ä½œ
- å®šæœŸæ›´æ–° Modbus è¨­å‚™éŸŒé«”

å¯¦æ–½æŒ‘æˆ°ï¼š

- è€èˆŠè¨­å‚™ä¸æ”¯æ´åŠ å¯†
- å³æ™‚æ€§è¦æ±‚èˆ‡å®‰å…¨æ€§è¡çª
- å¤§é‡æ—¢æœ‰ç³»çµ±éœ€è¦æ”¹é€ 
- äººå“¡åŸ¹è¨“æˆæœ¬é«˜æ˜‚

è§£æ±ºæ–¹æ¡ˆï¼š
âœ“ ä½¿ç”¨å®‰å…¨é–˜é“å™¨
âœ“ åˆ†éšæ®µå‡ç´šè¨ˆç•«
âœ“ é¢¨éšªè©•ä¼°å°å‘
âœ“ ä¾›æ‡‰å•†åˆä½œæ¨¡å¼

```

### å…¨çƒæœ€ä½³å¯¦å‹™ç¶œåˆ

#### NIST Cybersecurity Framework æ‡‰ç”¨
```

Identify (è­˜åˆ¥)ï¼š

- è³‡ç”¢æ¸…å†Šï¼šæ‰€æœ‰ Modbus è¨­å‚™
- é¢¨éšªè©•ä¼°ï¼šå®šæœŸå¨è„…åˆ†æ
- æ²»ç†æ¶æ§‹ï¼šå®‰å…¨æ”¿ç­–åˆ¶å®š

Protect (ä¿è­·)ï¼š

- å­˜å–æ§åˆ¶ï¼šèº«ä»½é©—è­‰æ©Ÿåˆ¶
- è³‡æ–™å®‰å…¨ï¼šåŠ å¯†å’Œå‚™ä»½
- ç¶­è­·ï¼šå®šæœŸæ›´æ–°å’Œä¿®è£œ

Detect (æª¢æ¸¬)ï¼š

- ç›£æ§ï¼šå³æ™‚å¨è„…åµæ¸¬
- äº‹ä»¶ï¼šç•°å¸¸è¡Œç‚ºåˆ†æ
- é©—è­‰ï¼šå®‰å…¨æ§åˆ¶æœ‰æ•ˆæ€§

Respond (å›æ‡‰)ï¼š

- è¨ˆç•«ï¼šäº‹ä»¶å›æ‡‰ç¨‹åº
- é€šè¨Šï¼šåˆ©å®³é—œä¿‚äººé€šçŸ¥
- åˆ†æï¼šå¨è„…æƒ…å ±æ•´åˆ

Recover (æ¢å¾©)ï¼š

- æ¢å¾©ï¼šæ¥­å‹™é€£çºŒæ€§è¨ˆç•«
- æ”¹å–„ï¼šç¶“é©—å­¸ç¿’æ•´åˆ
- æºé€šï¼šå¾©åŸç‹€æ…‹å ±å‘Š

````

#### æ‡‰ç”¨å±¤å®‰å…¨å¼·åŒ–

**èº«ä»½é©—è­‰èˆ‡æˆæ¬Šç³»çµ±**

```python
import hashlib
import hmac
import json
import time
from cryptography.fernet import Fernet

class ModbusSecurityManager:
    def __init__(self, secret_key):
        self.secret_key = secret_key
        self.cipher = Fernet(Fernet.generate_key())
        self.user_database = {}
        self.audit_log = []

    def authenticate_request(self, api_key, signature, request_data):
        """é©—è­‰è«‹æ±‚èº«ä»½"""
        # æŸ¥æ‰¾ä½¿ç”¨è€…
        user_data = self.user_database.get(api_key)
        if not user_data:
            return False, "ç„¡æ•ˆçš„ API é‡‘é‘°"

        # é©—è­‰ç°½å
        expected_signature = hmac.new(
            self.secret_key.encode(),
            request_data.encode(),
            hashlib.sha256
        ).hexdigest()

        if not hmac.compare_digest(request_signature, expected_signature):
            return False, "è«‹æ±‚ç°½åç„¡æ•ˆ"

        return True, user_data

    def authorize_operation(self, user_data, operation):
        """æˆæ¬Šæª¢æŸ¥"""
        user_permissions = user_data['permissions']

        permission_mapping = {
            'read_coils': 'read',
            'read_discrete_inputs': 'read',
            'read_holding_registers': 'read',
            'read_input_registers': 'read',
            'write_single_coil': 'write',
            'write_single_register': 'write',
            'write_multiple_coils': 'write_bulk',
            'write_multiple_registers': 'write_bulk'
        }

        required_permission = permission_mapping.get(operation)
        if not required_permission:
            return False, f"æœªçŸ¥çš„æ“ä½œ: {operation}"

        if required_permission not in user_permissions:
            return False, f"æ¬Šé™ä¸è¶³: éœ€è¦ {required_permission}"

        return True, "æˆæ¬ŠæˆåŠŸ"

    def secure_modbus_request(self, api_key, signature, encrypted_request):
        """å®‰å…¨çš„ Modbus è«‹æ±‚è™•ç†"""
        try:
            # 1. è§£å¯†è«‹æ±‚
            decrypted_request = self.cipher.decrypt(encrypted_request.encode())
            request_data = json.loads(decrypted_request.decode())

            # 2. é©—è­‰èº«ä»½
            auth_success, user_data = self.authenticate_request(
                api_key, signature, encrypted_request
            )

            if not auth_success:
                return self.create_error_response("èªè­‰å¤±æ•—", user_data)

            # 3. æˆæ¬Šæª¢æŸ¥
            operation = request_data.get('operation')
            auth_success, auth_message = self.authorize_operation(user_data, operation)

            if not auth_success:
                return self.create_error_response("æˆæ¬Šå¤±æ•—", auth_message)

            # 4. åŸ·è¡Œ Modbus æ“ä½œ
            result = self.execute_modbus_operation(request_data)

            # 5. è¨˜éŒ„ç¨½æ ¸æ—¥èªŒ
            self.log_operation(user_data['username'], operation, request_data, result)

            # 6. åŠ å¯†å›æ‡‰
            response = {
                'success': True,
                'data': result,
                'timestamp': time.time()
            }

            encrypted_response = self.cipher.encrypt(json.dumps(response).encode())
            return encrypted_response.decode()

        except Exception as e:
            return self.create_error_response("è™•ç†éŒ¯èª¤", str(e))

    def execute_modbus_operation(self, request_data):
        """åŸ·è¡Œ Modbus æ“ä½œ"""
        operation = request_data['operation']
        params = request_data['parameters']

        # é€£ç·šåˆ°å¯¦éš›çš„ Modbus è¨­å‚™
        client = ModbusTCPClient(params['host'], params.get('port', 502))
        client.connect()

        try:
            if operation == 'read_holding_registers':
                result = client.read_holding_registers(
                    params['address'],
                    params['count']
                )
                return {'registers': result}

            elif operation == 'write_single_register':
                client.write_single_register(
                    params['address'],
                    params['value']
                )
                return {'status': 'success'}

            # å…¶ä»–æ“ä½œ...

        finally:
            client.close()

    def log_operation(self, username, operation, request_data, result):
        """è¨˜éŒ„æ“ä½œæ—¥èªŒ"""
        log_entry = {
            'timestamp': time.time(),
            'username': username,
            'operation': operation,
            'parameters': request_data.get('parameters', {}),
            'success': result.get('success', False),
            'ip_address': request_data.get('client_ip'),
            'user_agent': request_data.get('user_agent')
        }

        self.audit_log.append(log_entry)

        # å¯ä»¥æ“´å±•ç‚ºå¯«å…¥è³‡æ–™åº«æˆ–æ—¥èªŒæª”æ¡ˆ
        print(f"ç¨½æ ¸æ—¥èªŒ: {log_entry}")

# å®‰å…¨é…ç½®ç®¡ç†
class SecurityConfiguration:
    def __init__(self):
        self.config = {
            'access_control': {
                'require_authentication': True,
                'session_timeout': 3600,  # 1 å°æ™‚
                'max_failed_attempts': 3,
                'lockout_duration': 900   # 15 åˆ†é˜
            },
            'encryption': {
                'algorithm': 'AES-256',
                'key_rotation_interval': 86400,  # 24 å°æ™‚
                'require_tls': True
            },
            'audit': {
                'log_all_operations': True,
                'log_failed_attempts': True,
                'retention_days': 90
            },
            'rate_limiting': {
                'requests_per_minute': 60,
                'burst_limit': 10
            }
        }

    def validate_configuration(self):
        """é©—è­‰å®‰å…¨é…ç½®"""
        issues = []

        # æª¢æŸ¥èªè­‰è¨­å®š
        if not self.config['access_control']['require_authentication']:
            issues.append("å»ºè­°å•Ÿç”¨èªè­‰æ©Ÿåˆ¶")

        if self.config['access_control']['session_timeout'] > 7200:
            issues.append("æœƒè©±è¶…æ™‚æ™‚é–“éé•·ï¼Œå»ºè­°è¨­ç‚º 2 å°æ™‚ä»¥å…§")

        # æª¢æŸ¥åŠ å¯†è¨­å®š
        if not self.config['encryption']['require_tls']:
            issues.append("å»ºè­°å•Ÿç”¨ TLS åŠ å¯†")

        # æª¢æŸ¥ç¨½æ ¸è¨­å®š
        if not self.config['audit']['log_all_operations']:
            issues.append("å»ºè­°è¨˜éŒ„æ‰€æœ‰æ“ä½œä»¥ä¾¿ç¨½æ ¸")

        return issues

    def generate_security_recommendations(self):
        """ç”¢ç”Ÿå®‰å…¨å»ºè­°"""
        recommendations = []

        recommendations.extend([
            "å¯¦æ–½å¤šå› ç´ èªè­‰ (MFA)",
            "å®šæœŸæ›´æ–°å¯†ç¢¼å’Œ API é‡‘é‘°",
            "ä½¿ç”¨å¼·å¼åŠ å¯†æ¼”ç®—æ³•",
            "å¯¦æ–½ç¶²è·¯å­˜å–æ§åˆ¶æ¸…å–® (ACL)",
            "å®šæœŸé€²è¡Œå®‰å…¨ç¨½æ ¸",
            "å»ºç«‹äº‹ä»¶å›æ‡‰ç¨‹åº",
            "é€²è¡Œå®šæœŸçš„æ»²é€æ¸¬è©¦",
            "å¯¦æ–½è³‡æ–™å‚™ä»½å’Œæ¢å¾©ç¨‹åº"
        ])

        return recommendations
````

## 0x04 ç›£æ§èˆ‡æª¢æ¸¬ç³»çµ±

### å·¥æ§ç’°å¢ƒå³æ™‚ç›£æ§ç­–ç•¥

#### æ¡ˆä¾‹ç ”ç©¶ï¼šIndustroyer/CrashOverride æ”»æ“Šæª¢æ¸¬

**èƒŒæ™¯**ï¼š2016 å¹´çƒå…‹è˜­é›»åŠ›ç³»çµ±é­å—çš„ Industroyer æƒ¡æ„è»Ÿé«”æ”»æ“Šï¼Œå±•ç¤ºäº†é‡å°å·¥æ§ç³»çµ±çš„ç²¾å¯†ç›£æ§éœ€æ±‚ã€‚

**æ”»æ“ŠæŠ€è¡“åˆ†æ**ï¼š

- **T0830 - Man in the Middle**ï¼šæ”»æ“Šè€…åœ¨ SCADA ç³»çµ±èˆ‡ç¾å ´è¨­å‚™é–“å»ºç«‹ä¸­é–“äººæ”»æ“Š
- **T0842 - Network Connection Enumeration**ï¼šæƒæå·¥æ§ç¶²è·¯æ‹“æ’²èˆ‡è¨­å‚™æ¸…å–®
- **T0869 - Standard Application Layer Protocol**ï¼šåˆ©ç”¨åˆæ³•çš„ IEC 104ã€IEC 61850 ç­‰å”è­°é€²è¡Œæ”»æ“Š

**ç›£æ§æŒ‡æ¨™èˆ‡æª¢æ¸¬æ–¹æ³•**ï¼š

1. **é€£ç·šè¡Œç‚ºç›£æ§**

   - æ­£å¸¸æƒ…æ³ï¼šHMI åˆ° PLC çš„é€£ç·šæ‡‰ä¿æŒç©©å®šä¸”å¯é æ¸¬
   - ç•°å¸¸æŒ‡æ¨™ï¼šéé æœŸçš„æ–°é€£ç·šã€é€£ç·šé »ç‡ç•°å¸¸å¢åŠ 
   - æª¢æ¸¬æ¡ˆä¾‹ï¼šç•¶ç™¼ç¾è¶…éé è¨­é–¾å€¼ï¼ˆå¦‚ 50 å€‹åŒæ™‚é€£ç·šï¼‰æ™‚è§¸ç™¼è­¦å ±

2. **å”è­°ç•°å¸¸æª¢æ¸¬**

   - æ­£å¸¸æƒ…æ³ï¼šModbus åŠŸèƒ½ç¢¼ä½¿ç”¨æ¨¡å¼æ‡‰ç¬¦åˆè¨­å‚™æ“ä½œè¦å¾‹
   - ç•°å¸¸æŒ‡æ¨™ï¼šç•°å¸¸åŠŸèƒ½ç¢¼åºåˆ—ã€éŒ¯èª¤å›æ‡‰æ¯”ä¾‹è¶…é 10%
   - æª¢æ¸¬æ¡ˆä¾‹ï¼šé€£çºŒçš„è¨ºæ–·åŠŸèƒ½ç¢¼è«‹æ±‚å¯èƒ½è¡¨ç¤ºè¨­å‚™æƒæè¡Œç‚º

3. **æ™‚é–“æ¨¡å¼åˆ†æ**
   - æ­£å¸¸æƒ…æ³ï¼šå·¥æ§é€šè¨Šæ‡‰éµå¾ªç”Ÿç”¢é€±æœŸå’Œæ’ç¨‹
   - ç•°å¸¸æŒ‡æ¨™ï¼šéæ­£å¸¸å·¥ä½œæ™‚é–“çš„å¤§é‡é€šè¨Šæ´»å‹•
   - æª¢æ¸¬æ¡ˆä¾‹ï¼šæ·±å¤œæ™‚æ®µçš„è¨­å‚™é…ç½®è®Šæ›´æ“ä½œ

#### å¯¦éš›éƒ¨ç½²æ¡ˆä¾‹ï¼šå°ç£æŸçŸ³åŒ–å» ç›£æ§ç³»çµ±

**éƒ¨ç½²èƒŒæ™¯**ï¼š2019 å¹´å°ç£æŸå¤§å‹çŸ³åŒ–å» åœ¨ Triton/TRISIS æ”»æ“Šäº‹ä»¶å¾Œï¼Œå…¨é¢å‡ç´šç›£æ§ç³»çµ±

**ç›£æ§æ¶æ§‹**ï¼š

- **ç¶²è·¯å±¤ç›£æ§**ï¼šæ·±åº¦å°åŒ…æª¢æ¸¬ (DPI) åˆ†ææ‰€æœ‰ Modbus TCP æµé‡
- **è¨­å‚™å±¤ç›£æ§**ï¼šå®‰å…¨æ€§ PLC ç›£æ§å·¥ç¨‹å¸«ç«™æ“ä½œè¡Œç‚º
- **æ‡‰ç”¨å±¤ç›£æ§**ï¼šSCADA ç³»çµ±æ•´åˆ SIEM å¹³å°é€²è¡Œé—œè¯åˆ†æ

**é—œéµæª¢æ¸¬èƒ½åŠ›**ï¼š

- å³æ™‚æª¢æ¸¬ç•°å¸¸çš„å¯«å…¥æŒ‡ä»¤çµ„åˆ
- è­˜åˆ¥æœªæˆæ¬Šçš„è¨­å‚™é…ç½®è®Šæ›´
- ç›£æ§é—œéµå®‰å…¨åƒæ•¸çš„ç•°å¸¸è®ŠåŒ–

#### è­¦å ±ç³»çµ±è¨­è¨ˆåŸå‰‡

åƒè€ƒ NIST ç¶²è·¯å®‰å…¨æ¡†æ¶ï¼Œå»ºç«‹åˆ†å±¤è­¦å ±æ©Ÿåˆ¶ï¼š

**Level 1 - è³‡è¨Šè­¦å ±**

- è§¸ç™¼æ¢ä»¶ï¼šè¼•å¾®çš„å”è­°ç•°å¸¸æˆ–é€£ç·šè®ŠåŒ–
- å›æ‡‰å‹•ä½œï¼šè¨˜éŒ„äº‹ä»¶ï¼Œç„¡éœ€ç«‹å³ä»‹å…¥
- å¯¦ä¾‹ï¼šå–®ä¸€è¨­å‚™çš„é€šè¨Šå»¶é²å¢åŠ 

**Level 2 - è­¦å‘Šè­¦å ±**

- è§¸ç™¼æ¢ä»¶ï¼šå¯ç–‘è¡Œç‚ºæ¨¡å¼æˆ–æœªçŸ¥è¨­å‚™å‡ºç¾
- å›æ‡‰å‹•ä½œï¼šé€šçŸ¥å€¼ç­å·¥ç¨‹å¸«ï¼Œå¢å¼·ç›£æ§
- å¯¦ä¾‹ï¼šæ–°çš„ IP ä½å€å˜—è©¦ Modbus é€£ç·š

**Level 3 - å±æ€¥è­¦å ±**

- è§¸ç™¼æ¢ä»¶ï¼šæ˜ç¢ºçš„æƒ¡æ„æ´»å‹•æˆ–å®‰å…¨å¨è„…
- å›æ‡‰å‹•ä½œï¼šç«‹å³é€šçŸ¥å®‰å…¨åœ˜éšŠï¼Œå•Ÿå‹•æ‡‰è®Šç¨‹åº
- å¯¦ä¾‹ï¼šæª¢æ¸¬åˆ°èˆ‡ Triton ç›¸ä¼¼çš„å®‰å…¨ç³»çµ±æ“ä½œåºåˆ—

#### åœ‹éš›æœ€ä½³å¯¦å‹™æ•´åˆ

**æ­ç›Ÿ NIS2 æŒ‡ä»¤è¦æ±‚**ï¼š

- 24/7 é€£çºŒç›£æ§èƒ½åŠ›
- äº‹ä»¶æª¢æ¸¬æ™‚é–“ä¸è¶…é 4 å°æ™‚
- è‡ªå‹•åŒ–å¨è„…æƒ…å ±æ•´åˆ

**ç¾åœ‹ NERC CIP æ¨™æº–**ï¼š

- é—œéµè³‡ç”¢çš„å³æ™‚ç›£æ§
- ç•°å¸¸è¡Œç‚ºçš„è‡ªå‹•åŒ–æª¢æ¸¬
- å®‰å…¨äº‹ä»¶çš„åˆ†ç´šå›æ‡‰æ©Ÿåˆ¶

### ç•°å¸¸æª¢æ¸¬èˆ‡å¨è„…çµæ•

#### æ©Ÿå™¨å­¸ç¿’è¼”åŠ©æª¢æ¸¬

**æ¡ˆä¾‹ï¼šColonial Pipeline æ”»æ“Šå¾Œçš„æ”¹é€²**

2021 å¹´ Colonial Pipeline é­å— DarkSide å‹’ç´¢è»Ÿé«”æ”»æ“Šå¾Œï¼Œç¾åœ‹èƒ½æºéƒ¨é–€å»£æ³›æ¡ç”¨ AI é©…å‹•çš„ç•°å¸¸æª¢æ¸¬ï¼š

- **åŸºæº–è¡Œç‚ºå»ºæ¨¡**ï¼šå»ºç«‹æ­£å¸¸æ“ä½œçš„æµé‡åŸºæº–ç·š
- **çµ±è¨ˆç•°å¸¸æª¢æ¸¬**ï¼šè­˜åˆ¥åé›¢æ­£å¸¸æ¨¡å¼çš„é€šè¨Šè¡Œç‚º
- **å¨è„…çµæ•**ï¼šä¸»å‹•æœå°‹æ½›åœ¨çš„æ”»æ“ŠæŒ‡æ¨™ (IoC)

**æª¢æ¸¬æ•ˆèƒ½æŒ‡æ¨™**ï¼š

- å¹³å‡æª¢æ¸¬æ™‚é–“ï¼šå¾æ•¸å°æ™‚ç¸®çŸ­è‡³æ•¸åˆ†é˜
- èª¤å ±ç‡ï¼šå¾ 30% é™ä½è‡³ 5% ä»¥ä¸‹
- å¨è„…è¦†è“‹ç‡ï¼šæ¶µè“‹ MITRE ATT&CK for ICS 90% çš„æ”»æ“ŠæŠ€è¡“

```python
        if self.metrics['request_rate']:
            timestamps = [m['timestamp'] for m in self.metrics['request_rate']]
            values = [m['value'] for m in self.metrics['request_rate']]

            axes[0, 1].plot(timestamps, values, color='orange')
            axes[0, 1].set_title('è«‹æ±‚é€Ÿç‡')
            axes[0, 1].set_ylabel('è«‹æ±‚/åˆ†é˜')

        # éŒ¯èª¤ç‡
        if self.metrics['error_rate']:
            timestamps = [m['timestamp'] for m in self.metrics['error_rate']]
            values = [m['value'] for m in self.metrics['error_rate']]

            axes[1, 0].plot(timestamps, values, color='red')
            axes[1, 0].set_title('éŒ¯èª¤ç‡')
            axes[1, 0].set_ylabel('éŒ¯èª¤ç‡')

        # è­¦å ±çµ±è¨ˆ
        alert_types = {}
        for alert in self.alerts:
            alert_type = alert['type']
            alert_types[alert_type] = alert_types.get(alert_type, 0) + 1

        if alert_types:
            axes[1, 1].bar(alert_types.keys(), alert_types.values())
            axes[1, 1].set_title('è­¦å ±é¡å‹åˆ†å¸ƒ')
            axes[1, 1].set_ylabel('æ•¸é‡')

        plt.tight_layout()
        plt.savefig('modbus_security_dashboard.png', dpi=300, bbox_inches='tight')
        plt.show()

# å¨è„…æƒ…å ±æ•´åˆ

class ThreatIntelligence:
    def __init__(self):
        self.threat_feeds = {}
        self.ioc_database = {
            'malicious_ips': set(),
            'suspicious_patterns': [],
            'known_vulnerabilities': []
        }

    def update_threat_feeds(self):
        """æ›´æ–°å¨è„…æƒ…å ±"""
        # é€™è£¡å¯ä»¥æ•´åˆå¤–éƒ¨å¨è„…æƒ…å ±æº
        # ä¾‹å¦‚ï¼šCERT, ICS-CERT, å•†æ¥­å¨è„…æƒ…å ±æœå‹™

        # æ¨¡æ“¬å¨è„…æƒ…å ±æ›´æ–°
        new_malicious_ips = [
            '192.168.100.50',  # å·²çŸ¥çš„æ”»æ“Š IP
            '10.0.0.99',       # å¦ä¸€å€‹æƒ¡æ„ IP
        ]

        self.ioc_database['malicious_ips'].update(new_malicious_ips)

        # æ›´æ–°æ”»æ“Šæ¨¡å¼
        new_patterns = [
            {
                'name': 'modbus_reconnaissance',
                'pattern': 'sequential_function_code_scan',
                'severity': 'medium'
            },
            {
                'name': 'data_exfiltration',
                'pattern': 'bulk_register_read',
                'severity': 'high'
            }
        ]

        self.ioc_database['suspicious_patterns'].extend(new_patterns)

    def check_indicators(self, ip_address, traffic_pattern):
        """æª¢æŸ¥å¨è„…æŒ‡æ¨™"""
        threats_found = []

        # æª¢æŸ¥æƒ¡æ„ IP
        if ip_address in self.ioc_database['malicious_ips']:
            threats_found.append({
                'type': 'malicious_ip',
                'severity': 'high',
                'description': f'å·²çŸ¥æƒ¡æ„ IP: {ip_address}'
            })

        # æª¢æŸ¥æ”»æ“Šæ¨¡å¼
        for pattern in self.ioc_database['suspicious_patterns']:
            if self.match_pattern(traffic_pattern, pattern['pattern']):
                threats_found.append({
                    'type': 'suspicious_pattern',
                    'severity': pattern['severity'],
                    'description': f'æª¢æ¸¬åˆ°å¯ç–‘æ¨¡å¼: {pattern["name"]}'
                })

        return threats_found

    def match_pattern(self, traffic_pattern, threat_pattern):
        """æ¨¡å¼åŒ¹é…é‚è¼¯"""
        # ç°¡åŒ–çš„æ¨¡å¼åŒ¹é…ï¼Œå¯¦éš›æ‡‰ç”¨æœƒæ›´è¤‡é›œ
        if threat_pattern == 'sequential_function_code_scan':
            # æª¢æŸ¥æ˜¯å¦æœ‰é€£çºŒçš„åŠŸèƒ½ç¢¼æƒæ
            function_codes = traffic_pattern.get('function_codes', [])
            return len(set(function_codes)) > 5

        elif threat_pattern == 'bulk_register_read':
            # æª¢æŸ¥æ˜¯å¦æœ‰å¤§é‡æš«å­˜å™¨è®€å–
            read_operations = traffic_pattern.get('read_operations', [])
            total_registers = sum(op.get('quantity', 0) for op in read_operations)
            return total_registers > 1000

        return False

```

## 0x05 äº‹ä»¶å›æ‡‰èˆ‡æ¢å¾©

### å·¥æ§å®‰å…¨äº‹ä»¶å›æ‡‰æ¡†æ¶

#### æ¡ˆä¾‹ç ”ç©¶ï¼šTRITON/TRISIS æ”»æ“Šçš„äº‹ä»¶å›æ‡‰

**æ”»æ“ŠèƒŒæ™¯**ï¼š2017 å¹´ä¸­æ±æŸçŸ³åŒ–å» é­å— TRITON æƒ¡æ„è»Ÿé«”æ”»æ“Šï¼Œè©²æ”»æ“Šå°ˆé–€é‡å° Schneider Electric çš„ Triconex å®‰å…¨å„€å™¨ç³»çµ± (SIS)ã€‚

**ATT&CK for ICS æŠ€è¡“å°æ‡‰**ï¼š

- **T0856 - Spoof Reporting Message**ï¼šå½é€ å®‰å…¨ç³»çµ±å ±å‘Š
- **T0885 - Commonly Used Port**ï¼šåˆ©ç”¨æ¨™æº–é€šè¨ŠåŸ é€²è¡Œæ”»æ“Š
- **T0816 - Device Restart/Shutdown**ï¼šæ“æ§å®‰å…¨ç³»çµ±é‡å•Ÿ

#### åˆ†å±¤äº‹ä»¶å›æ‡‰ç­–ç•¥

**ç¬¬ä¸€å±¤ï¼šè‡ªå‹•åŒ–æª¢æ¸¬èˆ‡ç«‹å³å›æ‡‰**

åƒè€ƒ NIST SP 800-53 æ§åˆ¶æªæ–½ï¼Œå»ºç«‹è‡ªå‹•åŒ–å›æ‡‰æ©Ÿåˆ¶ï¼š

1. **IP ä½å€å°é–å›æ‡‰**

   - è§¸ç™¼æ¢ä»¶ï¼šæª¢æ¸¬åˆ°æƒ¡æ„ IP é€²è¡Œ Modbus æƒæ
   - è‡ªå‹•å‹•ä½œï¼šé˜²ç«ç‰†ç«‹å³å°é–è©² IP 1 å°æ™‚
   - é€šçŸ¥æ©Ÿåˆ¶ï¼šå³æ™‚å‘Šè­¦ç™¼é€è‡³ SOC åœ˜éšŠ
   - å¯¦éš›æ¡ˆä¾‹ï¼š2020 å¹´æŸå°ç£è£½é€ å» æˆåŠŸé˜»æ“‹ä¾†è‡ªä¸­åœ‹çš„ APT æ”»æ“Š

2. **åŠŸèƒ½ç¢¼æƒææª¢æ¸¬**
   - è§¸ç™¼æ¢ä»¶ï¼šçŸ­æ™‚é–“å…§å¤§é‡ç•°å¸¸åŠŸèƒ½ç¢¼è«‹æ±‚
   - è‡ªå‹•å‹•ä½œï¼šå•Ÿå‹•æ·±åº¦å°åŒ…æª¢æ¸¬ï¼Œè¨˜éŒ„å®Œæ•´é€šè¨Šå…§å®¹
   - å‡ç´šæ©Ÿåˆ¶ï¼šè¶…éé–¾å€¼æ™‚å‡ç´šç‚ºäººå·¥èª¿æŸ¥
   - åƒè€ƒæ¨™æº–ï¼šIEC 62443-3-3 SR 6.1 å¯©è¨ˆäº‹ä»¶æª¢æ¸¬

**ç¬¬äºŒå±¤ï¼šå¨è„…ç‹©çµèˆ‡èª¿æŸ¥å›æ‡‰**

åŸºæ–¼ SANS äº‹ä»¶å›æ‡‰æµç¨‹çš„èª¿æŸ¥éšæ®µï¼š

3. **æ·±åº¦èª¿æŸ¥ç¨‹åº**
   - è­‰æ“šæ”¶é›†ï¼šä¿å­˜å®Œæ•´çš„ç¶²è·¯æµé‡å’Œç³»çµ±æ—¥èªŒ
   - å¨è„…æƒ…å ±æ¯”å°ï¼šèˆ‡ CISA å·¥æ§å¨è„…æŒ‡æ¨™é€²è¡Œæ¯”å°
   - æ©«å‘ç§»å‹•åˆ†æï¼šæª¢æŸ¥æ”»æ“Šè€…æ˜¯å¦å·²æ»²é€å…¶ä»–ç³»çµ±
   - å¯¦éš›æ¡ˆä¾‹ï¼š2019 å¹´æŒªå¨ Norsk Hydro é‹æ¥­å…¬å¸æ”»æ“Šèª¿æŸ¥éç¨‹

**ç¬¬ä¸‰å±¤ï¼šé—œéµäº‹ä»¶ç·Šæ€¥å›æ‡‰**

åƒè€ƒ Colonial Pipeline äº‹ä»¶çš„æ‡‰æ€¥è™•ç†ï¼š

4. **è³‡æ–™æ“ç¸±äº‹ä»¶å›æ‡‰**
   - ç«‹å³éš”é›¢ï¼šå—å½±éŸ¿è¨­å‚™å¾ç¶²è·¯ä¸­å®Œå…¨éš”é›¢
   - å‚™ä»½å•Ÿå‹•ï¼šåˆ‡æ›è‡³å‚™æ´ç³»çµ±ç¶­æŒç”Ÿç”¢
   - é‘‘è­˜ä¿å…¨ï¼šä¿å­˜æ”»æ“Šè­‰æ“šä¾›å¾ŒçºŒåˆ†æ
   - æ³•è¦é€šå ±ï¼šä¾æ“šå„åœ‹ CISA è¦æ±‚é€²è¡Œé€šå ±

#### åœ‹éš›äº‹ä»¶å›æ‡‰æœ€ä½³å¯¦å‹™

**æ­ç›Ÿ NIS2 æŒ‡ä»¤è¦æ±‚**ï¼š

- äº‹ä»¶æª¢æ¸¬å¾Œ 24 å°æ™‚å…§é€šå ±ä¸»ç®¡æ©Ÿé—œ
- é—œéµåŸºç¤è¨­æ–½ 4 å°æ™‚å…§é€šå ±
- å®Œæ•´äº‹ä»¶å ±å‘Šæ–¼ 1 å€‹æœˆå…§æäº¤

**ç¾åœ‹ CISA å·¥æ§äº‹ä»¶é€šå ±**ï¼š

- ICS-CERT å³æ™‚é€šå ±æ©Ÿåˆ¶
- è‡ªé¡˜æ€§å¨è„…æƒ…å ±åˆ†äº«
- è·¨éƒ¨é–€å”èª¿å›æ‡‰

#### æ¥­å‹™é€£çºŒæ€§èˆ‡ç½é›£å¾©åŸ

**æ¡ˆä¾‹ï¼šå¾·åœ‹é‹¼éµå» é«˜çˆæ”»æ“Šå¾Œçš„å¾©åŸ**

2014 å¹´å¾·åœ‹æŸé‹¼éµå» é­å— APT æ”»æ“Šï¼Œæ”»æ“Šè€…é€šéé­šå‰å¼é‡£é­šé€²å…¥ä¼æ¥­ç¶²è·¯ï¼Œæœ€çµ‚é€ æˆé«˜çˆç„¡æ³•æ­£å¸¸é—œé–‰ï¼Œè¨­å‚™åš´é‡æå£ã€‚

**å¾©åŸç­–ç•¥æ¡†æ¶**ï¼š

1. **ç·Šæ€¥æ‡‰è®Šæªæ–½**

   - äººå·¥æ“ä½œæ¥ç®¡ï¼šç«‹å³åˆ‡æ›è‡³æ‰‹å‹•æ§åˆ¶æ¨¡å¼
   - å®‰å…¨åœæ©Ÿç¨‹åºï¼šä¾ç…§æ—¢å®š SOP å®‰å…¨åœæ­¢ç”Ÿç”¢è¨­å‚™
   - é€šè¨Šéš”é›¢ï¼šæ–·é–‹èˆ‡å¤–éƒ¨ç¶²è·¯çš„æ‰€æœ‰é€£ç·š

2. **ç³»çµ±é‡å»ºéšæ®µ**

   - å…¨é¢è³‡å®‰æª¢æŸ¥ï¼šé‡æ–°å®‰è£æ‰€æœ‰å·¥æ§è»Ÿé«”
   - ç¶²è·¯æ¶æ§‹é‡è¨­ï¼šå¯¦æ–½æ–°çš„ç¶²è·¯åˆ†æ®µç­–ç•¥
   - å®‰å…¨åŸºæº–æå‡ï¼šå°å…¥ IEC 62443 Level 3 é˜²è­·

3. **ç‡Ÿé‹æ¢å¾©éšæ®µ**
   - åˆ†éšæ®µé‡å•Ÿï¼šå¾éé—œéµç³»çµ±é–‹å§‹é€æ­¥æ¢å¾©
   - åŠ å¼·ç›£æ§ï¼šéƒ¨ç½² 24/7 å·¥æ§å°ˆç”¨ SOC
   - æŒçºŒæ”¹é€²ï¼šå»ºç«‹å®šæœŸå®‰å…¨æ¼”ç·´æ©Ÿåˆ¶

#### äº‹ä»¶å­¸ç¿’èˆ‡æ”¹é€²

**å°ç£åŠå°é«”å» çš„äº‹ä»¶å›æ‡‰æ”¹é€²æ¡ˆä¾‹**

åƒè€ƒ 2021 å¹´æŸåœ‹éš›æ™¶åœ“ä»£å·¥å» çš„ç¶²è·¯å®‰å…¨äº‹ä»¶ï¼š

**æ”¹é€²é‡é»**ï¼š

- å»ºç«‹å·¥æ§å°ˆç”¨çš„ SIEM å¹³å°
- å°å…¥é›¶ä¿¡ä»»ç¶²è·¯æ¶æ§‹
- å¼·åŒ–ä¾›æ‡‰éˆå®‰å…¨ç®¡ç†
- å»ºç«‹è·¨å» å€çš„äº‹ä»¶å›æ‡‰è¯é˜²æ©Ÿåˆ¶

**æ•ˆæœè©•ä¼°**ï¼š

- äº‹ä»¶æª¢æ¸¬æ™‚é–“å¾æ•¸å¤©ç¸®çŸ­è‡³æ•¸å°æ™‚
- èª¤å ±ç‡é™ä½ 80%
- å¾©åŸæ™‚é–“ç›®æ¨™ (RTO) å¾ 72 å°æ™‚ç¸®çŸ­è‡³ 12 å°æ™‚

### é…ç½®å‚™ä»½èˆ‡æ¢å¾©ç³»çµ±

#### è‡ªå‹•åŒ–å‚™ä»½ç­–ç•¥

**åƒè€ƒ Schneider Electric æœ€ä½³å¯¦å‹™**ï¼š

**é…ç½®å‚™ä»½ç¯„åœ**ï¼š

- PLC ç¨‹å¼ç¢¼èˆ‡åƒæ•¸è¨­å®š
- HMI ç•«é¢é…ç½®èˆ‡ä½¿ç”¨è€…æ¬Šé™
- ç¶²è·¯è¨­å‚™å®‰å…¨æ”¿ç­–
- SCADA ç³»çµ±è³‡æ–™åº«çµæ§‹

**å‚™ä»½é »ç‡å»ºè­°**ï¼š

- é—œéµç”Ÿç”¢ç³»çµ±ï¼šæ¯æ—¥è‡ªå‹•å‚™ä»½
- ä¸€èˆ¬ç›£æ§ç³»çµ±ï¼šæ¯é€±è‡ªå‹•å‚™ä»½
- é…ç½®è®Šæ›´å¾Œï¼šç«‹å³æ‰‹å‹•å‚™ä»½
- é‡å¤§ç¶­è­·å‰ï¼šå®Œæ•´ç³»çµ±å‚™ä»½

**ç•°åœ°å‚™ä»½è¦æ±‚**ï¼š

- å‚™ä»½è³‡æ–™åŠ å¯†å„²å­˜
- ç•°åœ°å‚™ä»½é»è·é›¢ä¸»ç«™ > 100 å…¬é‡Œ
- å‚™ä»½å®Œæ•´æ€§å®šæœŸé©—è­‰
- å¾©åŸç¨‹åºå®šæœŸæ¼”ç·´

#### å¿«é€Ÿå¾©åŸæ©Ÿåˆ¶

**é‡‘ç´šå¾©åŸæ¨™æº–** (åƒè€ƒ Tier IV è³‡æ–™ä¸­å¿ƒæ¨™æº–)ï¼š

- å¾©åŸæ™‚é–“ç›®æ¨™ (RTO)ï¼š< 4 å°æ™‚
- å¾©åŸé»ç›®æ¨™ (RPO)ï¼š< 1 å°æ™‚
- è³‡æ–™å®Œæ•´æ€§ï¼š99.99%
- å¾©åŸæˆåŠŸç‡ï¼š> 95%

**å¾©åŸå„ªå…ˆç´šæ’åº**ï¼š

1.  ç”Ÿå‘½å®‰å…¨ç›¸é—œç³»çµ±
2.  ç’°å¢ƒä¿è­·ç›£æ§ç³»çµ±
3.  é—œéµç”Ÿç”¢æ§åˆ¶ç³»çµ±
4.  ä¸€èˆ¬ç›£æ§èˆ‡è³‡æ–™æ”¶é›†ç³»çµ±

        # å•Ÿå‹•å‚™ç”¨ç³»çµ±
        self.activate_backup_system(affected_device)

        # é€šçŸ¥é—œéµäººå“¡
        self.notify_critical_staff(incident)

        return {
            'action': 'critical_response',
            'device_isolated': affected_device,
            'backup_activated': True,
            'staff_notified': True
        }

    def generate_incident_report(self, incident_id):
    """ç”¢ç”Ÿäº‹ä»¶å ±å‘Š"""
    incident = next((i for i in self.response_log if i['id'] == incident_id), None)

        if not incident:
            return None

        report = {
            'incident_id': incident_id,
            'summary': self.generate_incident_summary(incident),
            'timeline': self.generate_timeline(incident),
            'impact_assessment': self.assess_impact(incident),
            'response_actions': incident.get('auto_response', {}),
            'recommendations': self.generate_recommendations(incident)
        }

        return report

    def generate_incident_summary(self, incident):
    """ç”¢ç”Ÿäº‹ä»¶æ‘˜è¦"""
    return f"""
    äº‹ä»¶é¡å‹: {incident['type']}
    åš´é‡ç¨‹åº¦: {incident['severity']}
    ç™¼ç”Ÿæ™‚é–“: {incident['timestamp']}
    ç‹€æ…‹: {incident['status']}

        æè¿°: {incident['details'].get('description', 'ç„¡')}
        ä¾†æºIP: {incident['details'].get('source_ip', 'æœªçŸ¥')}
        ç›®æ¨™è¨­å‚™: {incident['details'].get('target_device', 'æœªçŸ¥')}
        """

    def assess_impact(self, incident):
    """è©•ä¼°å½±éŸ¿"""
    impact_levels = {
    'malicious_ip': 'medium',
    'function_code_scan': 'low',
    'data_manipulation': 'high',
    'dos_attack': 'high'
    }

        impact_level = impact_levels.get(incident['type'], 'medium')

        return {
            'level': impact_level,
            'affected_systems': incident['details'].get('affected_systems', []),
            'downtime': incident['details'].get('downtime', 0),
            'data_compromised': incident['details'].get('data_compromised', False)
        }

# å‚™ä»½å’Œæ¢å¾©ç³»çµ±

class BackupRecoverySystem:
def **init**(self):
self.backup_schedule = {
'full_backup': {'frequency': 'daily', 'time': '02:00'},
'incremental_backup': {'frequency': 'hourly'},
'config_backup': {'frequency': 'on_change'}
}
self.backup_locations = ['local', 'remote', 'cloud']

    def create_configuration_backup(self, device_ip):
        """å»ºç«‹è¨­å‚™é…ç½®å‚™ä»½"""
        try:
            # é€£æ¥è¨­å‚™ä¸¦è®€å–é…ç½®
            client = ModbusTCPClient(device_ip)
            client.connect()

            # è®€å–é—œéµé…ç½®æš«å­˜å™¨
            config_data = {}
            config_ranges = [
                (40001, 100),  # ç³»çµ±åƒæ•¸
                (40101, 50),   # æ§åˆ¶åƒæ•¸
                (40201, 30)    # å®‰å…¨è¨­å®š
            ]

            for start_addr, count in config_ranges:
                try:
                    registers = client.read_holding_registers(start_addr, count)
                    config_data[f"range_{start_addr}"] = registers
                except Exception as e:
                    print(f"è®€å–åœ°å€ {start_addr} å¤±æ•—: {e}")

            # å„²å­˜å‚™ä»½
            backup_record = {
                'device_ip': device_ip,
                'timestamp': datetime.now(),
                'config_data': config_data,
                'checksum': self.calculate_checksum(config_data)
            }

            self.save_backup(backup_record)
            return True

        except Exception as e:
            print(f"å‚™ä»½å»ºç«‹å¤±æ•—: {e}")
            return False
        finally:
            client.close()

    def restore_configuration(self, device_ip, backup_timestamp=None):
        """æ¢å¾©è¨­å‚™é…ç½®"""
        # è¼‰å…¥å‚™ä»½
        backup_record = self.load_backup(device_ip, backup_timestamp)

        if not backup_record:
            return False, "æ‰¾ä¸åˆ°å‚™ä»½è¨˜éŒ„"

        try:
            client = ModbusTCPClient(device_ip)
            client.connect()

            # æ¢å¾©é…ç½®
            for range_key, registers in backup_record['config_data'].items():
                start_addr = int(range_key.split('_')[1])

                # æ‰¹æ¬¡å¯«å…¥æš«å­˜å™¨
                for i, value in enumerate(registers):
                    client.write_single_register(start_addr + i, value)

            return True, "é…ç½®æ¢å¾©æˆåŠŸ"

        except Exception as e:
            return False, f"é…ç½®æ¢å¾©å¤±æ•—: {e}"
        finally:
            client.close()

    def calculate_checksum(self, config_data):
        """è¨ˆç®—é…ç½®æ ¡é©—å’Œ"""
        config_str = json.dumps(config_data, sort_keys=True)
        return hashlib.sha256(config_str.encode()).hexdigest()

    def save_backup(self, backup_record):
        """å„²å­˜å‚™ä»½è¨˜éŒ„"""
        # é€™è£¡å¯ä»¥å¯¦ä½œå¤šé‡å‚™ä»½å„²å­˜
        backup_file = f"backup_{backup_record['device_ip']}_{backup_record['timestamp'].strftime('%Y%m%d_%H%M%S')}.json"

        with open(backup_file, 'w') as f:
            json.dump(backup_record, f, default=str, indent=2)

        print(f"å‚™ä»½å·²å„²å­˜: {backup_file}")

````

## 0x06 ç³»åˆ—ç¸½çµèˆ‡å¯¦å‹™å»ºè­°

### å®‰å…¨æª¢æŸ¥æ¸…å–®

```markdown
# Modbus TCP å®‰å…¨æª¢æŸ¥æ¸…å–®

## ç¶²è·¯å®‰å…¨ âœ“

- [ ] å¯¦æ–½ç¶²è·¯åˆ†æ®µéš”é›¢
- [ ] éƒ¨ç½²å·¥æ¥­é˜²ç«ç‰†
- [ ] å•Ÿç”¨å…¥ä¾µæª¢æ¸¬ç³»çµ±
- [ ] å¯¦æ–½ VPN æˆ–å°ˆç·šé€£æ¥
- [ ] å®šæœŸé€²è¡Œç¶²è·¯æƒæ

## è¨­å‚™å®‰å…¨ âœ“

- [ ] æ›´æ”¹é è¨­å¯†ç¢¼
- [ ] åœç”¨ä¸å¿…è¦çš„æœå‹™
- [ ] æ›´æ–°éŸŒé«”ç‰ˆæœ¬
- [ ] å¯¦æ–½å­˜å–æ§åˆ¶
- [ ] å®šæœŸå®‰å…¨ç¨½æ ¸

## é€šè¨Šå®‰å…¨ âœ“

- [ ] ä½¿ç”¨ TLS åŠ å¯†
- [ ] å¯¦æ–½è¨Šæ¯èªè­‰
- [ ] å•Ÿç”¨æ—¥èªŒè¨˜éŒ„
- [ ] ç›£æ§ç•°å¸¸æµé‡
- [ ] å¯¦æ–½é€Ÿç‡é™åˆ¶

## æ“ä½œå®‰å…¨ âœ“

- [ ] å»ºç«‹å®‰å…¨æ”¿ç­–
- [ ] é€²è¡Œäººå“¡è¨“ç·´
- [ ] å¯¦æ–½è®Šæ›´ç®¡ç†
- [ ] å®šæœŸå‚™ä»½é…ç½®
- [ ] æº–å‚™äº‹ä»¶å›æ‡‰è¨ˆç•«

## ç›£æ§èˆ‡å›æ‡‰ âœ“

- [ ] éƒ¨ç½² SIEM ç³»çµ±
- [ ] å»ºç«‹ç›£æ§å„€è¡¨æ¿
- [ ] è¨­å®šè­¦å ±æ©Ÿåˆ¶
- [ ] å»ºç«‹å›æ‡‰ç¨‹åº
- [ ] å®šæœŸæ¼”ç·´
````

### æœ€çµ‚å»ºè­°

1. **åˆ†å±¤é˜²è­·**ï¼šä¸è¦ä¾è³´å–®ä¸€é˜²è­·æªæ–½
2. **æŒçºŒç›£æ§**ï¼šå¯¦æ–½ 24/7 å®‰å…¨ç›£æ§
3. **å®šæœŸæ›´æ–°**ï¼šä¿æŒç³»çµ±å’Œå®‰å…¨æªæ–½çš„æ›´æ–°
4. **äººå“¡åŸ¹è¨“**ï¼šå®šæœŸé€²è¡Œå®‰å…¨æ„è­˜åŸ¹è¨“
5. **æ¼”ç·´æ¸¬è©¦**ï¼šå®šæœŸé€²è¡Œå®‰å…¨æ¼”ç·´å’Œæ¸¬è©¦

## 0x07 è³‡æºèˆ‡å»¶ä¼¸é–±è®€

### ç›¸é—œæ¨™æº–å’ŒæŒ‡å¼•

- IEC 62443: å·¥æ¥­æ§åˆ¶ç³»çµ±å®‰å…¨æ¨™æº–
- NIST Cybersecurity Framework
- ISO 27001: è³‡è¨Šå®‰å…¨ç®¡ç†ç³»çµ±
- NERC CIP: é›»åŠ›ç³»çµ±ç¶²è·¯å®‰å…¨æ¨™æº–

### å¯¦ç”¨å·¥å…·

- Wireshark: ç¶²è·¯å°åŒ…åˆ†æ
- Nmap: ç¶²è·¯æƒæå·¥å…·
- ModbusPal: Modbus æ¨¡æ“¬å™¨
- Splunk: SIEM å¹³å°

---

**ç³»åˆ—å®Œçµæ„Ÿè¬**

æ„Ÿè¬æ‚¨è·Ÿéš¨å®Œæ•´çš„ Modbus TCP æ·±åº¦è§£æç³»åˆ—ï¼å¾åŸºç¤å”è­°åˆ°é«˜ç´šæ”»é˜²ï¼Œæˆ‘å€‘ä¸€èµ·æ¢ç´¢äº†å·¥æ§ç¶²è·¯å®‰å…¨çš„å„å€‹é¢å‘ã€‚

è¨˜ä½ï¼š**å®‰å…¨æ˜¯ä¸€å€‹æŒçºŒçš„éç¨‹ï¼Œè€Œéçµ‚é»ã€‚**

é¡˜é€™å€‹ç³»åˆ—èƒ½å¹«åŠ©æ‚¨å»ºæ§‹æ›´å®‰å…¨çš„å·¥æ§ç’°å¢ƒï¼

_æœ¬æ–‡ç‚º Modbus TCP æ·±åº¦è§£æç³»åˆ—æœ€çµ‚ç¯‡ - å®Œçµ_
